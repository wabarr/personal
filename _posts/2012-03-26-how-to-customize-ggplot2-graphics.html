---
layout: post
title: How to customize ggplot2 graphics
date: '2012-03-26T15:20:00.000-05:00'
author: Andrew Barr
tags:
- ggplot2
- R Tips
modified_time: '2012-10-10T09:14:48.508-05:00'
thumbnail: http://2.bp.blogspot.com/-1H8vTipdCqc/T2jydyXeMZI/AAAAAAAAIuQ/nXXiIJhgPbE/s72-c/myplot.jpg
blogger_id: tag:blogger.com,1999:blog-9204176314411862946.post-5465298989445004967
blogger_orig_url: http://www.ancienteco.com/2012/03/how-to-customize-ggplot2-graphics.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">I consider <a href="http://had.co.nz/ggplot2/">ggplot2</a> to be nothing short of a revolution in R graphics. I simply haven't found anything like this package for quickly and elegantly producing usable graphics.&nbsp; <a href="http://www.ancienteco.com/2012/03/basic-introduction-to-ggplot2.html">I covered the quick and dirty basics of ggplot2 in a previous post</a>. Now I am going to go into how you can tweak and customize ggplot graphics to look the way you want.<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">#load ggplot2</div><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">library(ggplot2)</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">#create some sample data</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">variable1&lt;-rnorm(200,sd=3) #200 random points from normal dist<br />variable2&lt;-variable1 * .4 + rnorm(200,sd=.5) #correlated variable<br />category&lt;-sample(c("A","B","C"),200,replace=T) #categorical variable<br /><br />myDF&lt;-data.frame(variable1,variable2,category) #put in data frame<br />rm(list=c("variable1","variable2","category")) #delete unneeded variables</span><br /><br />So now we have a single object (a dataframe) which contains two correlated continuous variables and one categorical variable.&nbsp; Using the qplot() function from ggplot we can make a quick scatterplot of the continuous variables that is color coded by the categorical variable.<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">qplot(x=variable1,y=variable2,data=myDF,color=category,geom="point")</div><br />That creates this nice looking default plot.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-1H8vTipdCqc/T2jydyXeMZI/AAAAAAAAIuQ/nXXiIJhgPbE/s1600/myplot.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="350" src="http://2.bp.blogspot.com/-1H8vTipdCqc/T2jydyXeMZI/AAAAAAAAIuQ/nXXiIJhgPbE/s400/myplot.jpg" width="400" /></a></div><b>Changing Themes</b><br />Now....lets say that you don't want a solid gray background, and you want a bigger default font size. These are really common tweaks, so ggplot2 makes it easy to change the default "theme" in order to get white backgrounds and custom text sizes. You can set this globally for an entire R session with the following command.<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">theme_set(theme_bw(24))</div><br />Then we can reuse the single line of code we already used to make a scatter plot, and the "black and white" theme will be applied, along with a larger base font size (the default is 12, so we have set it to be twice as large as the default).&nbsp; Note that the different font sizes of axes, tick marks, legend titles, etc are automatically calculated relative to the base size that we set to 24.<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">qplot(x=variable1,y=variable2,data=myDF,color=category,geom="point")</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-nUKG8buAkWg/T2jzpmBhEHI/AAAAAAAAIuY/ksCc98uWQmU/s1600/myplot.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="350" src="http://1.bp.blogspot.com/-nUKG8buAkWg/T2jzpmBhEHI/AAAAAAAAIuY/ksCc98uWQmU/s400/myplot.jpg" width="400" /></a></div><br />It is easy to change theme elements for a single plot, rather than changing them globally as we did before with theme_set().&nbsp; If I decide I want to go back to the default gray theme for any given plot, I can simply add a theme element to the plot object produced by the qplot() function.<br /><br /><b>Note</b>: I save the result of the qplot() function into a variable called myPlot.&nbsp; This doesn't result in anything getting printed to the screen, it just saves the ggplot object in a variable, that I can print whenever I want and manipulate to my heart's content.&nbsp; This is a useful way to avoid typing commands again.&nbsp; The plot gets printed to the screen in the second line of code.<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">myPlot&lt;-qplot(x=category,y=variable1,data=myDF,geom="boxplot",fill=category)</div><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">myPlot + theme_gray(12) </span><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-dMgRCeHL_qg/T2j2JJUwGNI/AAAAAAAAIug/ZaPZtI9STRs/s1600/myplot.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="350" src="http://1.bp.blogspot.com/-dMgRCeHL_qg/T2j2JJUwGNI/AAAAAAAAIug/ZaPZtI9STRs/s400/myplot.jpg" width="400" />&nbsp;</a></div><div class="separator" style="clear: both; text-align: center;"><br /></div>This produces a boxplot with a gray background, because we have added the theme_gray(12) theme element to the plot. Note that this command also resulted in a smaller base font size.&nbsp; Also note that the next plot we do will have a white background and the larger base font size, because the theme_set() command we did earlier is still in effect globally.<br /><br /><b>Changing individual theme elements</b><br /><br />Although all I did was add the function theme_gray(12) to the previous plot plot, ggplot2 did several things.&nbsp; It changed the background to gray AND the gridlines to white (rather than black gridlines and white background), AND changed the base font size.&nbsp; It did these several independent things behind the scenes, but you can of course manually change all the theme elements yourself.&nbsp; Lets say you like super-heinous-ugly plots....you might want to do the following.<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">myPlot + opts(plot.background=theme_rect(fill="yellow"),<br />panel.background=theme_rect(fill='purple'))</div><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-faThBCiVV5c/T2pBY5N7nnI/AAAAAAAAIuo/sdV9lFPrvR4/s1600/myplot.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-faThBCiVV5c/T2pBY5N7nnI/AAAAAAAAIuo/sdV9lFPrvR4/s400/myplot.jpg" width="400" />&nbsp;</a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">This is where the rubber hits the road for tweaking theme elements.&nbsp; We can change theme elements by using the opts() function to pass new values for various theme elements.&nbsp; There are about 30 theme elements you might want to change (<a href="http://had.co.nz/ggplot2/docs/opts.html">listed here</a>).&nbsp; In our case we changed two: the plot.background element and the panel.background element.&nbsp; Note the use of theme_rect(fill="yellow") to specify that we want a yellow plot background.&nbsp; Any time you tweak a theme element with the opts() command, you do so with one of five functions.&nbsp; </div><ul style="text-align: left;"><li>theme_blank() - used to prevent an element from being drawn</li><li>theme_text() - used to tweak text and labels</li><li>theme_line() &amp; theme_segment() - for drawing lines and segments for things like axes</li><li>theme_rect() - for things like the overall plot background and the plot panel background</li></ul>There are various parameters you can tweak for these different theme functions look up the help file for the one you need.&nbsp; For example ?theme_text<br /><br /><b>Annotating a Plot </b><br />We can use the annotate() function as a quick way to add text to our plot.&nbsp; I position the text label by specifying the coordinates where I want the center of the text, in this case centered at 0 on the x-axis and at the maximum y value. Specifying x and y coordinates works on a boxplot also....just think of the categories as sequential integers.&nbsp; <br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">myScatterplot&lt;-qplot(x=variable1,y=variable2,data=myDF,color=category,geom="point")</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">myScatterplot + annotate("text", x = 0, y = max(myDF$variable2), label = "Relationship between x and y") </div><br /><br /></div>